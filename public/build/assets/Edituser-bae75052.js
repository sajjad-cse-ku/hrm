import{q as B,r as b,j as e,y as C}from"./app-10261b6d.js";import _ from"./Mainlayout-68f7394a.js";import"./ThemeConfig-49c8c6b2.js";import"./Footer-69ce0f77.js";import"./Header-14eb6d0b.js";import"./Dropdown-5750824d.js";import"./nonIterableRest-5e64c36b.js";import"./Sidebar-c7545ffd.js";function R(){const{user:n,roles:h,permissions:f,currentuser:q,rolewisepermission:u}=B().props,g=n.permissioninfo.map(s=>s.permission_id);n.roleinfo.map(s=>s.role_id),n.rolebasedpermissioninfo;const j=n.hasRoleBasedPermissions,p=Object.keys(u).map(s=>({roleId:parseInt(s),permissions:Object.keys(u[s]).map(l=>({permissionId:parseInt(l),permission_name:u[s][l]}))})),[N,y]=b.useState({}),[i,d]=b.useState({userid:n.id,username:n.username,firstName:n.first_name,lastName:n.last_name,email:n.email,status:n.status,mobile:n.mobile,gender:n.gender,dateOfBirth:n.date_of_birth,avatar:n.avatar,password:"",selectedPermissions:g,roleBasedPermissions:j,selectedRoles:[]}),w=(s,l)=>{d(l?a=>({...a,selectedPermissions:[...a.selectedPermissions,s]}):a=>({...a,selectedPermissions:a.selectedPermissions.filter(o=>o!==s)}))},v=(s,l,a)=>{d(o=>{const{roleBasedPermissions:r}=o,m=r[s]||[],c=a?[...m,l]:m.filter(x=>x!==l);return{...o,roleBasedPermissions:{...r,[s]:c}}})},t=s=>{const{name:l,value:a}=s.target;d({...i,[l]:a})},P=async s=>{s.preventDefault(),console.log(i),C.post("/admin/users/update",i)},k=(s,l)=>{if(y(a=>({...a,[s]:l})),l){const a=p.find(o=>o.roleId===s).permissions.map(o=>o.permissionId);d(o=>({...o,roleBasedPermissions:{...o.roleBasedPermissions,[s]:a}}))}else d(a=>({...a,roleBasedPermissions:{...a.roleBasedPermissions,[s]:[]}}))};return e.jsx("div",{className:"grid xl:grid-cols-1 gap-6 grid-cols-1",children:e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"flex items-center justify-between mb-5",children:e.jsx("h5",{className:"font-semibold text-lg dark:text-white-light",children:"Edit User"})}),e.jsx("div",{className:"createuser-form",children:e.jsx("div",{className:"w-full mx-auto",children:e.jsxs("form",{onSubmit:P,className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4",children:[e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"hidden",name:"userid",id:"userid",value:i.userid,onChange:t,required:!0}),e.jsxs("div",{className:"md:flex md:justify-between",children:[e.jsxs("div",{className:"md:w-1/2 px-3 mb-6 md:mb-0",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Username"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"username",id:"username",value:i.username,onChange:t,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"First Name"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"firstName",id:"firstName",value:i.firstName,onChange:t,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Last Name"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"lastName",id:"lastName",value:i.lastName,onChange:t,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"email",name:"email",id:"email",value:i.email,onChange:t,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Status"}),e.jsxs("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"status",id:"status",value:i.status,onChange:t,required:!0,children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"md:w-1/2 px-3",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Mobile"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"tel",name:"mobile",id:"mobile",value:i.mobile,onChange:t})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Gender"}),e.jsxs("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"gender",id:"gender",value:i.gender,onChange:t,children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Date of Birth"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"date",name:"dateOfBirth",id:"dateOfBirth",value:i.dateOfBirth,onChange:t})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Avatar"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"avatar",id:"avatar",value:i.avatar,onChange:t})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"password",name:"password",id:"password",value:i.password,onChange:t,required:!0})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Roles Based Permissions"}),e.jsx("div",{children:h.map((s,l)=>e.jsxs("div",{className:`flex items-center mb-2 ${l!==h.length-1?"border-b border-gray-300":""}`,children:[e.jsxs("div",{className:"role-name w-3/12",children:[" ",e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox mr-5",name:`selectedRoleBasedPermissions[${s.id}]`,id:`role-${s.id}-permission-select-all`,checked:N[s.id]||!1,onChange:a=>k(s.id,a.target.checked)}),e.jsx("span",{children:s.role_name})]})]}),e.jsxs("div",{className:"permissions-list w-9/12",children:[" ",p.filter(a=>a.roleId===s.id).map((a,o)=>e.jsx("div",{className:"permissionunderorles",children:a.permissions.map((r,m)=>{var c;return e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox",name:`selectedRoleBasedPermissions[${s.id}]`,id:`role-${s.id}-permission-${r.permissionId}`,checked:(c=i.roleBasedPermissions[s.id])==null?void 0:c.includes(r.permissionId),onChange:x=>v(s.id,r.permissionId,x.target.checked)}),e.jsx("span",{children:r.permission_name})]},m)})},o))]})]},s.id))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Individual Permissions"}),e.jsx("div",{className:"all-permission-lists",children:f.map(s=>e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{className:"form-checkbox",type:"checkbox",name:"permissions[]",id:`permission-${s.id}`,checked:i.selectedPermissions.includes(s.id),onChange:l=>w(s.id,l.target.checked)}),e.jsx("span",{children:s.permission_name})]},s.id))})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",children:"Update User"})})]})})})]})})}R.layout=n=>e.jsx(_,{children:n});export{R as default};
