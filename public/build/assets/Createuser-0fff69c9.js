import{q as w,r as p,j as e,y as P}from"./app-da728457.js";import k from"./Mainlayout-7fcc381d.js";import"./ThemeConfig-942266fd.js";import"./Footer-93a16f13.js";import"./HeaderV3-f5723e8c.js";import"./Dropdown-2aa762ac.js";import"./i18next-b264b5f3.js";import"./nonIterableRest-5e64c36b.js";import"./iconBase-530cc4cf.js";import"./SidebarV3-3a51bfdb.js";import"./index-e2ecdd97.js";function C(){const{roles:d,permissions:b,currentuser:B,rolewisepermission:u}=w().props,h=Object.keys(u).map(s=>({roleId:parseInt(s),permissions:Object.keys(u[s]).map(a=>({permissionId:parseInt(a),permission_name:u[s][a]}))})),[g,f]=p.useState({}),[l,t]=p.useState({username:"",firstName:"",lastName:"",email:"",status:1,mobile:"",gender:"Male",dateOfBirth:"",avatar:"",password:"",selectedPermissions:[],roleBasedPermissions:{}}),j=(s,a)=>{t(a?i=>({...i,selectedPermissions:[...i.selectedPermissions,s]}):i=>({...i,selectedPermissions:i.selectedPermissions.filter(n=>n!==s)}))},N=(s,a,i)=>{t(n=>{const{roleBasedPermissions:o}=n,c=o[s]||[],m=i?[...c,a]:c.filter(x=>x!==a);return{...n,roleBasedPermissions:{...o,[s]:m}}})},r=s=>{const{name:a}=s.target,i=a==="avatar"?s.target.files[0]:s.target.value;t({...l,[a]:i})},y=async s=>{s.preventDefault(),P.post("/admin/users/store",l)},v=(s,a)=>{if(f(i=>({...i,[s]:a})),a){const i=h.find(n=>n.roleId===s).permissions.map(n=>n.permissionId);t(n=>({...n,roleBasedPermissions:{...n.roleBasedPermissions,[s]:i}}))}else t(i=>({...i,roleBasedPermissions:{...i.roleBasedPermissions,[s]:[]}}))};return e.jsx("div",{className:"grid xl:grid-cols-1 gap-6 grid-cols-1",children:e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"flex items-center justify-between mb-5",children:e.jsx("h5",{className:"font-semibold text-lg dark:text-white-light",children:"Create User"})}),e.jsx("div",{className:"createuser-form",children:e.jsx("div",{className:"w-full mx-auto",children:e.jsxs("form",{onSubmit:y,className:"bg-white rounded  pt-6 pb-8 mb-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Username"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"username",id:"username",value:l.username,onChange:r,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"First Name"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"firstName",id:"firstName",value:l.firstName,onChange:r,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Last Name"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"lastName",id:"lastName",value:l.lastName,onChange:r,required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"email",name:"email",id:"email",value:l.email,onChange:r,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Mobile"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"tel",name:"mobile",id:"mobile",value:l.mobile,onChange:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Status"}),e.jsxs("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"status",id:"status",value:l.status,onChange:r,required:!0,children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Gender"}),e.jsxs("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"gender",id:"gender",value:l.gender,onChange:r,children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Date of Birth"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"date",name:"dateOfBirth",id:"dateOfBirth",value:l.dateOfBirth,onChange:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"password",name:"password",id:"password",value:l.password,onChange:r,required:!0})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 gap-4",children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Avatar"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"file",name:"avatar",id:"avatar",multiple:!0,onChange:r})]})})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Roles Based Permissions"}),e.jsx("div",{children:d.map((s,a)=>e.jsxs("div",{className:`flex items-center mb-2 ${a!==d.length-1?"border-b border-gray-300":""}`,children:[e.jsxs("div",{className:"role-name w-3/12",children:[" ",e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox mr-5",name:`selectedRoleBasedPermissions[${s.id}]`,id:`role-${s.id}-permission-select-all`,checked:g[s.id]||!1,onChange:i=>v(s.id,i.target.checked)}),e.jsx("span",{children:s.role_name})]})]}),e.jsxs("div",{className:"permissions-list w-9/12",children:[" ",h.filter(i=>i.roleId===s.id).map((i,n)=>e.jsx("div",{className:"permissionunderorles",children:i.permissions.map((o,c)=>{var m;return e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox",name:`selectedRoleBasedPermissions[${s.id}]`,id:`role-${s.id}-permission-${o.permissionId}`,checked:(m=l.roleBasedPermissions[s.id])==null?void 0:m.includes(o.permissionId),onChange:x=>N(s.id,o.permissionId,x.target.checked)}),e.jsx("span",{children:o.permission_name})]},c)})},n))]})]},s.id))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Individual Permissions"}),e.jsx("div",{className:"all-permission-lists",children:b.map(s=>e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{className:"form-checkbox",type:"checkbox",name:"permissions[]",id:`permission-${s.id}`,checked:l.selectedPermissions.includes(s.id),onChange:a=>j(s.id,a.target.checked)}),e.jsx("span",{children:s.permission_name})]},s.id))})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",children:"Create User"})})]})})})]})})}C.layout=d=>e.jsx(k,{children:d});export{C as default};
