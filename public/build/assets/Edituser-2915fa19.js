import{q as _,r as b,j as e,R as B,y as C}from"./app-da728457.js";import R from"./Mainlayout-7fcc381d.js";import"./ThemeConfig-942266fd.js";import"./Footer-93a16f13.js";import"./HeaderV3-f5723e8c.js";import"./Dropdown-2aa762ac.js";import"./i18next-b264b5f3.js";import"./nonIterableRest-5e64c36b.js";import"./iconBase-530cc4cf.js";import"./SidebarV3-3a51bfdb.js";import"./index-e2ecdd97.js";function $(){const{user:n,roles:x,all_permissions:f,currentuser:q,rolewisepermission:u}=_().props,g=n.permissioninfo.map(s=>s.permission_id);n.roleinfo.map(s=>s.role_id),n.rolebasedpermissioninfo;const j=n.hasRoleBasedPermissions,p=Object.keys(u).map(s=>({roleId:parseInt(s),all_permissions:Object.keys(u[s]).map(l=>({permissionId:parseInt(l),permission_name:u[s][l]}))})),[N,y]=b.useState({}),[o,d]=b.useState({userid:n.id,username:n.username,firstName:n.first_name,lastName:n.last_name,email:n.email,status:n.status,mobile:n.mobile,gender:n.gender,dateOfBirth:n.date_of_birth,avatar:n.avatar,selectedPermissions:g,roleBasedPermissions:j,selectedRoles:[]}),v=(s,l)=>{d(l?i=>({...i,selectedPermissions:[...i.selectedPermissions,s]}):i=>({...i,selectedPermissions:i.selectedPermissions.filter(a=>a!==s)}))},w=(s,l,i)=>{d(a=>{const{roleBasedPermissions:t}=a,m=t[s]||[],c=i?[...m,l]:m.filter(h=>h!==l);return{...a,roleBasedPermissions:{...t,[s]:c}}})},r=s=>{const{name:l,value:i}=s.target;d({...o,[l]:i})},P=async s=>{s.preventDefault(),C.post("/admin/users/update",o)},k=(s,l)=>{if(y(i=>({...i,[s]:l})),l){const i=p.find(a=>a.roleId===s).all_permissions.map(a=>a.permissionId);d(a=>({...a,roleBasedPermissions:{...a.roleBasedPermissions,[s]:i}}))}else d(i=>({...i,roleBasedPermissions:{...i.roleBasedPermissions,[s]:[]}}))};return e.jsx("div",{className:"grid xl:grid-cols-1 gap-6 grid-cols-1",children:e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"flex items-center justify-between mb-5",children:e.jsx("h5",{className:"font-semibold text-lg dark:text-white-light",children:"Edit User"})}),e.jsx("div",{className:"createuser-form",children:e.jsx("div",{className:"w-full mx-auto",children:e.jsxs("form",{onSubmit:P,className:"bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4",children:[e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"hidden",name:"userid",id:"userid",value:o.userid,onChange:r,required:!0}),e.jsxs("div",{className:"md:flex md:justify-between",children:[e.jsxs("div",{className:"md:w-1/2 px-3 mb-6 md:mb-0",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Username"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"username",id:"username",value:o.username,onChange:r,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"First Name"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"firstName",id:"firstName",value:o.firstName,onChange:r,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Last Name"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"lastName",id:"lastName",value:o.lastName,onChange:r,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"email",name:"email",id:"email",value:o.email,onChange:r,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Status"}),e.jsxs("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"status",id:"status",value:o.status,onChange:r,required:!0,children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"md:w-1/2 px-3",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Mobile"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"tel",name:"mobile",id:"mobile",value:o.mobile,onChange:r})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Gender"}),e.jsxs("select",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"gender",id:"gender",value:o.gender,onChange:r,children:[e.jsx("option",{value:"Male",children:"Male"}),e.jsx("option",{value:"Female",children:"Female"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Date of Birth"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"date",name:"dateOfBirth",id:"dateOfBirth",value:o.dateOfBirth,onChange:r})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Avatar"}),e.jsx("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",type:"text",name:"avatar",id:"avatar",value:o.avatar,onChange:r})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Roles Based Permissions"}),e.jsx("div",{children:x.map((s,l)=>e.jsxs("div",{className:`flex items-center mb-2 ${l!==x.length-1?"border-b border-gray-300":""}`,children:[e.jsxs("div",{className:"role-name w-3/12",children:[" ",e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox mr-5",name:`selectedRoleBasedPermissions[${s.id}]`,id:`role-${s.id}-permission-select-all`,checked:N[s.id]||!1,onChange:i=>k(s.id,i.target.checked)}),e.jsx("span",{children:s.role_name})]})]}),e.jsxs("div",{className:"permissions-list w-9/12",children:[" ",p.filter(i=>i.roleId===s.id).map((i,a)=>e.jsx("div",{className:"permissionunderorles",children:i.all_permissions.map((t,m)=>{var c;return e.jsxs("label",{className:"inline-flex mr-3",children:[e.jsx("input",{type:"checkbox",className:"form-checkbox",name:`selectedRoleBasedPermissions[${s.id}]`,id:`role-${s.id}-permission-${t.permissionId}`,checked:(c=o.roleBasedPermissions[s.id])==null?void 0:c.includes(t.permissionId),onChange:h=>w(s.id,t.permissionId,h.target.checked)}),e.jsx("span",{children:t.permission_name})]},m)})},a))]})]},s.id))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Individual Permissions"}),e.jsx("div",{className:"all-permission-lists",children:f.sort((s,l)=>s.module_id-l.module_id).map((s,l,i)=>{var a;return e.jsxs(B.Fragment,{children:[l===0||s.module_id!==i[l-1].module_id?e.jsx("div",{className:"module-title",id:`moduleid-${s.module_id}`,children:e.jsx("h4",{children:(a=s==null?void 0:s.module)==null?void 0:a.name})}):null,e.jsxs("label",{className:"inline-flex mr-3","data-moduleid":s.module_id,children:[e.jsx("input",{type:"checkbox",className:"form-checkbox",name:"permissions[]",id:`permission-${s.id}`,checked:o.selectedPermissions.includes(s.id),onChange:t=>v(s.id,t.target.checked)}),e.jsx("span",{children:s.permission_name})]})]},s.id)})})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"submit",children:"Update User"})})]})})})]})})}$.layout=n=>e.jsx(R,{children:n});export{$ as default};
